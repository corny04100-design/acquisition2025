<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>취득세 계산</title>
<meta name="theme-color" content="#2c58ff" />
<link rel="manifest" href="manifest.webmanifest?v=20250916">
<link rel="icon" href="./icon-192-v5.png" sizes="192x192" />
<link rel="apple-touch-icon" href="./icon-512-v5.png" />
<style>
:root{
  --bg:#f9fafb; --card:#ffffff; --text:#111827; --text-sub:#6b7280;
  --brand:#2563eb; --brand-weak:#eff6ff; --sum-bg:#f3f4f6;
  --input-bg:#fefce8; --line:#e5e7eb; --shadow:rgba(0,0,0,.06);
  --warn:#dc2626; --muted:#9ca3af;
  --sky:#f7fbff; --sky-line:#e3f2ff;
  --green:#f0fdf4; --green-line:#dcfce7;
  --yellow:#fef9c3;
  --splash-a:#ecf3ff; --splash-b:#f5faff; --splash-accent:#2563eb;

  /* 메뉴 4칸 전용 색상 (서로 다른 파스텔톤) */
  --menu1:#e0f2fe; --menu1-border:#bae6fd; --menu1-hover:#dbeafe;      /* 하늘색 */
  --menu2:#ecfdf5; --menu2-border:#a7f3d0; --menu2-hover:#d1fae5;      /* 민트색 */
  --menu3:#e0f7fa; --menu3-border:#b2ebf2; --menu3-hover:#c8fafe;      /* 민트블루 */
  --menu4:#fff4e5; --menu4-border:#ffe0b2; --menu4-hover:#ffe8cc;      /* 연오렌지 */
}
html,body{margin:0;padding:0;height:100%;background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--text);line-height:1.6}
.hidden{display:none !important}

/* ===== 전체 화면 스플래시 ===== */
#splash{position:fixed; inset:0; z-index:9999; display:flex; align-items:center; justify-content:center; flex-direction:column; gap:18px;
  background:
    radial-gradient(1200px 800px at 10% 10%, rgba(37,99,235,.08), transparent 60%),
    radial-gradient(900px 700px at 90% 20%, rgba(16,185,129,.08), transparent 60%),
    radial-gradient(800px 600px at 30% 90%, rgba(99,102,241,.08), transparent 60%),
    linear-gradient(180deg, var(--splash-b), var(--splash-a));
  overflow:hidden;}
#splash .ring{position:absolute; width:140vmax; height:140vmax; border-radius:50%;
  background:radial-gradient(circle at center, rgba(37,99,235,.06), transparent 60%); animation: ringFloat 9s ease-in-out infinite;}
@keyframes ringFloat{0%,100%{transform:translate(-10%, -8%) rotate(0deg);} 50%{transform:translate(-6%, -12%) rotate(8deg);} }
#splash .card{background:rgba(255,255,255,.85); backdrop-filter:blur(8px); border:1px solid rgba(37,99,235,.15); border-radius:18px; box-shadow:0 20px 60px rgba(0,0,0,.12); padding:22px 26px; display:flex; align-items:center; gap:16px;}
#splash .art{width:84px;height:84px;flex:0 0 auto}
#splash .title-wrap{display:flex;flex-direction:column;gap:2px}
#splash h1{font-size:1.35rem;margin:0;color:#0f172a;font-weight:900;letter-spacing:-0.01em}
#splash .sub{font-size:.9rem;color:#334155}
#splash .bar{ width:min(340px, 80vw); height:6px; border-radius:999px; background:rgba(15,23,42,.12); overflow:hidden; box-shadow:inset 0 0 0 1px rgba(15,23,42,.06) }
#splash .bar > i{ display:block; height:100%; width:0%; background:linear-gradient(90deg, var(--splash-accent), #4f46e5); animation: loadGrow 2.5s linear forwards }
@keyframes loadGrow{ to{ width:100% } }

/* 공통 헤더 */
header.appbar{position:sticky;top:0;z-index:50;background:var(--card);backdrop-filter:blur(8px);border-bottom:1px solid var(--line);box-shadow:0 1px 3px var(--shadow)}
header .row{max-width:960px;margin:0 auto;padding:9px 16px;display:flex;align-items:center;gap:7px;flex-wrap:nowrap}
.brand{display:flex;align-items:center;gap:7px;font-weight:700;font-size:0.95rem;white-space:nowrap}
.app-actions{display:flex;gap:5px;margin-left:auto;flex-wrap:nowrap}
.icon-btn{padding:5px 9px;border:1px solid var(--line);border-radius:8px;background:var(--brand-weak);font-size:0.78rem;font-weight:700;color:var(--text);text-decoration:none;transition:background .15s;white-space:nowrap}
.icon-btn:hover{background:#dbeafe}
.icon-btn.icon-only{width:36px;height:36px;padding:0;display:inline-flex;align-items:center;justify-content:center}
.icon-btn.icon-only svg{width:19px;height:19px}
.icon-stroke{fill:none;stroke:#1f2937;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
.installed .btn-install{display:none !important}

/* 공통 레이아웃 */
.wrap{max-width:960px;margin:18px auto 70px;padding:0 16px}
.title{font-size:1.25rem;font-weight:800;margin-bottom:9px;text-align:center}
.card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:22px;box-shadow:0 4px 12px var(--shadow);margin-bottom:14px}
.btn{display:inline-flex;align-items:center;gap:6px;padding:9px 16px;border-radius:10px;background:var(--brand);color:#fff;font-weight:700;cursor:pointer;transition:filter .15s}
.btn:hover{filter:brightness(1.05)}
.warn{color:var(--warn);font-size:.85rem;margin-top:8px}

/* 메뉴 */
#view-menu .menu-wrap{max-width:640px;margin:0 auto}
.menu-grid{display:grid;grid-template-columns:1fr;gap:13px}
.menu-item{display:flex;align-items:center;gap:13px;padding:16px;border:1px solid var(--line);border-radius:14px;background:var(--card);box-shadow:0 4px 12px var(--shadow);cursor:pointer;text-decoration:none;color:inherit}
.menu-item:hover{background:#f8fafc}
.menu-num{min-width:34px;height:34px;border-radius:10px;display:flex;align-items:center;justify-content:center;background:var(--brand-weak);font-weight:800}
.menu-text{font-size:1rem;font-weight:700}

/* 안내 배너(메뉴 하단) */
.menu-notice{display:flex;align-items:center;gap:10px;margin-top:12px;padding:12px 14px;border:1px dashed var(--menu1-border);background:linear-gradient(0deg,#fff, var(--brand-weak));border-radius:12px;color:#0f172a;font-weight:700}
.menu-notice .badge{display:inline-flex;align-items:center;justify-content:center;padding:2px 8px;border-radius:999px;background:#dbeafe;color:#1e40af;font-size:.75rem;font-weight:900;margin-right:8px}
.menu-notice .em{text-decoration:underline;text-underline-offset:3px;font-weight:900}
/* ▶ 4개 항목 전용 색상(구분용) */
.menu-item.c1{background:var(--menu1); border-color:var(--menu1-border)}
.menu-item.c1:hover{background:var(--menu1-hover)}
.menu-item.c2{background:var(--menu2); border-color:var(--menu2-border)}
.menu-item.c2:hover{background:var(--menu2-hover)}
.menu-item.c3{background:var(--menu3); border-color:var(--menu3-border)}
.menu-item.c3:hover{background:var(--menu3-hover)}
.menu-item.c4{background:var(--menu4); border-color:var(--menu4-border)}
.menu-item.c4:hover{background:var(--menu4-hover)}
.menu-item.c1 .menu-num{background:#cfe7fb}
.menu-item.c2 .menu-num{background:#d7f7ea}
.menu-item.c3 .menu-num{background:#c2f2f6}
.menu-item.c4 .menu-num{background:#ffe0b2}

/* 표/입력 */
.grid{display:grid;grid-template-columns:50% 50%;gap:18px}
#view-calc1 .grid,#view-calc2 .grid,#view-calc3 .grid,#view-calc4 .grid{grid-template-columns:1fr 1fr}
/* ▼ 요청 반영: calc1도 단일열(아래로 배치)로 변경 */
#view-calc1 .grid{grid-template-columns:1fr !important}
#view-calc2 .grid,#view-calc3 .grid,#view-calc4 .grid{grid-template-columns:1fr !important}
.header-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
h2{font-size:1.03rem;margin:0}
h2 .unit{font-size:0.73rem;color:var(--text-sub)}
label{font-size:0.88rem;color:var(--text-sub);margin-bottom:3px;display:block}
input.num{width:70%;display:block;margin:0 auto;padding:11px;border:1px solid #d1d5db;border-radius:10px;background:var(--input-bg);text-align:right;font-size:1rem}
select.sel{width:70%;display:block;margin:0 auto;padding:11px;border:1px solid #d1d5db;border-radius:10px;background:#fff;font-size:1rem}
  
/* ▼ calc1: 선택 문구(현재값)와 목록 모두 가운데 정렬 */
#view-calc1 .sel{ text-align:center; text-align-last:center; }
#view-calc1 .sel option{ text-align:center; }

.table{width:100%;border-collapse:collapse;margin-top:8px;font-size:0.88rem}
.table th,.table td{padding:9px;border-bottom:1px solid var(--line)}
.table th{text-align:center;background:var(--bg)}
.table thead th:nth-child(2),.table thead th:nth-child(3),
.table tfoot th:nth-child(2),.table tfoot th:nth-child(3){text-align:right} 
.table td{text-align:right}
.table td:first-child{text-align:center}
tfoot tr{background:var(--sum-bg);font-weight:700}
.sum-box{background:var(--brand-weak);border:1px solid #bfdbfe;border-radius:12px;padding:14px;margin:10px 0;display:grid;grid-template-columns:50% 50%;gap:9px;text-align:center;font-weight:700}

/* 입력 그리드 / 날짜 */
#view-calc1 .input-grid,#view-calc2 .input-grid,#view-calc3 .input-grid,#view-calc4 .input-grid{display:grid;grid-template-columns:7fr 3fr;gap:10px;align-items:end;margin-bottom:10px}
#view-calc1 .input-grid input.num,#view-calc2 .input-grid input.num,#view-calc3 .input-grid input.num,#view-calc4 .input-grid input.num{width:50%}
#view-calc1 input.date,#view-calc2 input.date,#view-calc3 input.date,#view-calc4 input.date{display:block;margin:0 auto;padding:11px;border:1px solid #d1d5db;border-radius:10px;background:#ffffff;text-align:center;font-size:1rem}
.deadline-box{background:var(--brand-weak);border:1px dashed #bfdbfe;border-radius:12px;padding:10px;text-align:center;margin-top:8px}
.deadline-box .label{font-size:.78rem;color:#374151}
.deadline-box .value{font-size:1.03rem;font-weight:700}

/* 아이콘칩 & 체크박스 */
#view-calc3 .area-options,#view-calc4 .area-options{display:flex;flex-direction:column;gap:8px;margin:5px 0 7px 0}
.icon-chip{display:inline-flex;align-items:center;gap:10px;padding:8px 10px;border-radius:12px;border:1px solid var(--line);white-space:nowrap;box-shadow:0 1px 2px var(--shadow);width:fit-content}
.icon-chip.sky{background:var(--sky);border-color:var(--sky-line)}
.icon-chip.yellow{background:var(--yellow);border-color:#fde68a}
.icon-chip.green{background:var(--green);border-color:var(--green-line)}
.icon-chip label{display:inline-flex;align-items:center;gap:5px;margin:0}
.icon-chip .sep{opacity:.6}
.sep{opacity:.6}
#view-calc3 .type-options label span,#view-calc4 .type-options label span,
#view-calc3 .area-options label span,#view-calc4 .area-options label span{ color:#111827;font-size:1.0rem;font-weight:800; }
#view-calc3 input[type="checkbox"],#view-calc4 input[type="checkbox"]{ width:16px;height:16px;accent-color:#111827 }

/* calc3 라벨 가운데 */
#view-calc3 .input-grid .col-amount label,#view-calc3 .input-grid .col-date label{ text-align:center }

/* details 표 가운데 */
#view-calc2 details .table td,#view-calc2 details .table th,
#view-calc3 details .table td,#view-calc3 details .table th,
#view-calc4 details .table td,#view-calc4 details .table th{ text-align:center }
#view-calc2 details .table td,#view-calc3 details .table td,#view-calc4 details .table td{ width:50% }

/* 증여 view: '세율 및 과세표준'과 항목 굵게 */
#view-calc4 details summary{ font-weight:900 }
#view-calc4 details .table td,#view-calc4 details .table th{ font-weight:800 }

/* ===== 버튼/간이합계 25% 간격 (calc1~4 공통) ===== */
#view-calc1 .btn-row, #view-calc2 .btn-row, #view-calc3 .btn-row, #view-calc4 .btn-row{ display:flex; align-items:center; gap:10px; width:100%; }
.btn-row .quarter-gap{ flex:0 0 25%; } /* 가운데 정확히 25% 비움 */

/* 증여 view: 버튼 밑 간이 합계 표시 (공통 사용) */
.quick-sum{ display:inline-flex; align-items:center; gap:8px; margin:10px 0 0 0; padding:10px 12px; border:1px solid #bfdbfe; background:var(--brand-weak); border-radius:10px; width:fit-content; font-weight:800 }
.quick-sum .label{ margin-right:8px; color:#0f172a; font-size:.95rem; line-height:1 }
.quick-sum .value{ font-size:1.08rem; line-height:1 }

/* ====== ▶ 요청 반영: calc1 전용 스타일 ====== */
#view-calc1 .grid > .card:first-child .header-row h2{ text-align:center; width:100%; }
/* 전용면적 선택박스: 기존 98% → 현재 기준 70%로 축소(=68.6%) */
#view-calc1 #h_area.sel{ width:45%; }
/* 취득가액 숫자박스: calc1 기본 70%의 80% = 56% */
#view-calc1 #h_price.num{ width:45% !important; }
#view-calc1 #h_type.sel{ width:60%; }
#view-calc1 #h_sum_guide{ font-size:0.8rem !important; }
#view-calc1 .input-grid .col-amount label,
#view-calc1 .input-grid .col-date label{ text-align:center; color:#000; }
#view-calc1 #h_date{ font-weight:800; color:#000; }

/* ====== ▶ 추가 요청 반영: calc2 라벨 가운데 정렬 ====== */
#view-calc2 .input-grid .col-amount label,
#view-calc2 .input-grid .col-date label{ text-align:center; }

/* ====== ▶ calc3 안내문 폰트 축소(2단계) ====== */
#view-calc3 #상속_sum_guide{ font-size:0.8rem !important; }
  
/* 인쇄 최적화 */
@media print{
  @page{size:A4 portrait;margin:10mm}
  body{font-size:11pt}
  .wrap{max-width:100%;margin:0;padding:0}
  .grid{grid-template-columns:1fr 1fr;gap:7px}
  /* ▼ calc1은 인쇄에서도 단일열 유지 */
  #view-calc1 .grid{grid-template-columns:1fr !important}
  .card{padding:9px;box-shadow:none;border-color:#e5e7eb;margin-bottom:10px}
  .sum-box{margin:5px 0;padding:9px;grid-template-columns:50% 50%}
  .table{font-size:10pt}
  .table th,.table td{padding:5px}
  .title{margin:4px 0 8px 0;font-size:16pt}
}

/* PWA 모드 */
@media all and (display-mode: standalone), all and (display-mode: window-controls-overlay){
  .btn-install{display:none !important}
}

/* 미리보기 오버레이 */
#previewOverlay{position:fixed;inset:0;background:rgba(17,24,39,.6);backdrop-filter:blur(2px);display:none;align-items:center;justify-content:center;z-index:1000}
#previewOverlay.show{display:flex}
.preview-card{background:#fff;border-radius:12px;box-shadow:0 20px 60px rgba(0,0,0,.25);padding:12px;max-width:95vw;max-height:95vh;display:flex;flex-direction:column;gap:8px}
.preview-toolbar{display:flex;gap:8px;align-items:center;justify-content:space-between}
.preview-toolbar .left,.preview-toolbar .right{height:0;overflow:hidden}
.preview-page-wrap{flex:1 1 auto;display:flex;align-items:center;justify-content:center;overflow:auto}
.preview-page{width:794px;height:1123px;border:1px solid #e5e7eb;box-shadow:0 6px 20px rgba(0,0,0,.08);background:#fff;transform-origin:top left;position:relative}
.preview-content{position:absolute;inset:0;overflow:hidden;padding:12px}
.preview-content .wrap{max-width:100% !important;margin:0 !important;padding:0 8px !important}
.preview-content .grid{grid-template-columns:1fr 1fr !important;gap:8px !important}
/* ▼ 미리보기에서도 calc1은 단일열 유지 */
.preview-content #view-calc1 .grid{grid-template-columns:1fr !important}
.preview-content .card{padding:10px !important}
.preview-content .sum-box{margin:6px 0 !important;padding:10px !important}
.preview-content .table{font-size:10pt !important}
.preview-content .table th,.preview-content .table td{padding:6px !important}
.preview-content .title{margin:4px 0 8px 0 !important;font-size:16pt !important}
.preview-content header.appbar,.preview-content .app-actions,.preview-content #splash,.preview-content .menu-wrap{display:none !important}
.preview-scale{transform-origin: top left; display:inline-block;}
/* 안내 배너 (리프레시, 아이콘 제거·가독성 강화) */
.menu-notice{display:flex;align-items:center;justify-content:center;gap:8px;margin-top:14px;padding:12px 16px;border:1px solid var(--menu1-border);background:#fff;border-radius:12px;color:#0f172a;font-weight:800;letter-spacing:-0.01em;box-shadow:0 4px 12px var(--shadow);text-align:center;word-break:keep-all}
.menu-notice .chip{display:inline-flex;align-items:center;justify-content:center;padding:4px 12px;border-radius:999px;background:var(--brand-weak);border:1px solid #bfdbfe;font-weight:900}

</style>
</head>
<body>
  <!-- ===== 전체 화면 스플래시 ===== -->
  <div id="splash" role="status" aria-live="polite">
    <div class="ring" aria-hidden="true"></div>
    <div class="card" aria-hidden="true">
      <!-- 간단한 일러스트 -->
      <svg class="art" viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M12 48 L48 22 L84 48" fill="none" stroke="#2563eb" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
        <rect x="22" y="48" width="24" height="26" rx="3" fill="none" stroke="#1f2937" stroke-width="2"/>
        <rect x="30" y="58" width="8" height="16" rx="1.5" fill="none" stroke="#1f2937" stroke-width="2"/>
        <rect x="55" y="50" width="18" height="22" rx="2.5" fill="white" stroke="#2563eb" stroke-width="2"/>
        <line x1="59" y1="56" x2="71" y2="56" stroke="#2563eb" stroke-width="2" stroke-linecap="round"/>
        <line x1="59" y1="61" x2="71" y2="61" stroke="#2563eb" stroke-width="2" stroke-linecap="round"/>
        <line x1="59" y1="66" x2="71" y2="66" stroke="#2563eb" stroke-width="2" stroke-linecap="round"/>
        <rect x="6" y="58" width="16" height="18" rx="2.5" fill="white" stroke="#22c55e" stroke-width="2"/>
        <circle cx="11" cy="63" r="1.7" fill="#22c55e"/>
        <circle cx="17" cy="63" r="1.7" fill="#22c55e"/>
        <circle cx="11" cy="69" r="1.7" fill="#22c55e"/>
        <circle cx="17" cy="69" r="1.7" fill="#22c55e"/>
      </svg>
      <div class="title-wrap">
        <h1>개인 취득세 계산</h1>
        <div class="sub">주택·상가 매매/상속/증여</div>
      </div>
    </div>
    <div class="bar" aria-hidden="true"><i></i></div>
  </div>

  <!-- 메뉴 화면 -->
  <div id="view-menu" class="view">
    <header class="appbar">
      <div class="row">
        <div class="brand"><span>취득유형 선택</span></div>
        <div class="app-actions">
          <a class="icon-btn" target="_blank" href="https://www.law.go.kr/LSW/lsSc.do?query=%EC%A7%80%EB%B0%A9%EC%84%B8%EB%B2%95">🔍 지방세법</a>
          <a class="icon-btn" target="_blank" href="https://www.wetax.go.kr/etq/etp/epi/E070101M01.do">🧾 위택스</a>
          <a class="icon-btn btn-install" href="javascript:void(0)" onclick="openInstall()" title="앱 설치" aria-label="앱 설치">앱설치</a>
        </div>
      </div>
    </header>
    <div class="wrap">
      <div class="title">취득유형 선택</div>
      <div class="menu-wrap">
        <div class="menu-grid" role="navigation" aria-label="취득 유형 선택">
          <button class="menu-item c1" onclick="showView('calc1')">
            <div class="menu-num">1</div>
            <div>
              <div class="menu-text">주택 매매 취득</div>
            </div>
          </button>
          <button class="menu-item c2" onclick="showView('calc2')">
            <div class="menu-num">2</div>
            <div><div class="menu-text">상가(오피스텔) 매매 취득</div></div>
          </button>
          <button class="menu-item c3" onclick="showView('calc3')">
            <div class="menu-num">3</div>
            <div><div class="menu-text">상속 취득</div></div>
          </button>
          <button class="menu-item c4" onclick="showView('calc4')">
            <div class="menu-num">4</div>
            <div><div class="menu-text">증여 취득</div></div>
          </button>
        <div class="menu-notice" role="note" aria-label="안내">
  그 외 취득은
  <a class="chip" href="https://www.wetax.go.kr/tcp/loi/J030301M01.do" target="_blank" rel="noopener">
  관할구청 세무과
  </a>
  ,  피드백<a class="chip" href="mailto:corny04100@gmail.com" title="피드백 보내기">corny04100@gmail.com</a> 
</div>
</div>
      </div>
    </div>
  </div>

  <!-- 1: 주택 유상취득 -->
  <div id="view-calc1" class="view hidden" aria-labelledby="calc1-heading">
    <header class="appbar">
      <div class="row">
        <a class="icon-btn icon-only" href="javascript:void(0)" onclick="showView('menu')" title="뒤로" aria-label="뒤로">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path class="icon-stroke" d="M15 18l-6-6 6-6"/></svg>
        </a>
        <div class="brand"><span>2025년 취득세 계산(주택 매매)</span></div>
        <div class="app-actions">
          <a class="icon-btn" target="_blank" href="https://www.wetax.go.kr/tcp/loi/J030401M01.do" title="시가표준액 조회">시가표준액</a>
          <a class="icon-btn" target="_blank" href="https://www.realtyprice.kr/notice/main/mainBody.htm" title="주택가격 조회">주택가격</a>
          <a class="icon-btn" target="_blank" href="https://www.law.go.kr/LSW/lsSc.do?query=%EC%A7%80%EB%B0%A9%EC%84%B8%EB%B2%95">🔍 지방세법</a>
          <a class="icon-btn" target="_blank" href="https://www.wetax.go.kr/etq/etp/epi/E070101M01.do">🧾 위택스</a>
        </div>
      </div>
    </header>
    <div class="wrap">
      <h1 id="calc1-heading" class="title">2025년 취득세 계산(주택 매매)</h1>
      <div class="grid">
        <div class="card">
          <div class="header-row"><h2>1. 취득 정보 입력 <span class="unit">(단위: 원)</span></h2></div>
          <div class="input-grid">
            <div class="col col-amount">
              <label for="h_price">취득가액(매매가)</label>
              <input id="h_price" class="num" type="text" inputmode="numeric" placeholder="숫자만 입력" />
            </div>
            <div class="col col-date">
              <label for="h_date">잔금지급일</label>
              <input id="h_date" type="date" class="date" />
            </div>
          </div>

          <div class="input-grid">
            <div class="col col-amount">
              <label for="h_type">취득 구분</label>
              <select id="h_type" class="sel">
                <option value="normal1">일반과세</option>
                <option value="adj2">조정대상지역 2주택 중과</option>
                <option value="adj3">조정대상지역 3주택이상 중과</option>
              </select>
            </div>
            <div class="col col-date">
              <label for="h_area">전용면적</label>
              <select id="h_area" class="sel">
                <option value="under">85㎡ 이하</option>
                <option value="over">85㎡ 초과</option>
              </select>
            </div>
          </div>

          <div class="btn-row" style="margin-top:14px;">
            <button class="btn" onclick="calc1()">✍️ 계산하기</button>
            <div class="quarter-gap" aria-hidden="true"></div>
            <div id="h_quick_sum" class="quick-sum" role="status" aria-live="polite">
              <span class="label">총 합계 세액</span><span id="h_quick_sum_value" class="value">-</span>
            </div>
          </div>

          <details class="center-30" style="margin-top:16px" open>
            <summary>세율 및 과세표준</summary>
            <table class="table nowrap">
              <tbody>
                <tr><td>과세표준</td><td id="h_base">-</td></tr>
                <tr><td>취득세</td><td id="h_rate_acq">-</td></tr>
                <tr><td>농어촌특별세</td><td id="h_rate_nts">-</td></tr>
                <tr><td>지방교육세</td><td id="h_rate_edu">-</td></tr>
              </tbody>
            </table>
            <div class="deadline-box center-30" style="margin-top:10px">
              <div class="label">취득세 납부기한</div>
              <div class="value" id="h_deadline">-</div>
            </div>
          </details>
        </div>

        <div class="card">
          <h2>2. 산출 세액</h2>
          <div class="sum-box" role="status" aria-live="polite">
            <div>
              <div class="label">총 합계 세액</div>
              <div class="value" id="h_sum_total">-</div>
            </div>
            <div>
              <div class="label">납부 안내</div>
              <div class="value note nowrap" id="h_sum_guide">취득(잔금지급일)일로부터 60일 내</div>
            </div>
          </div>
          <table class="table">
            <thead><tr><th>세목</th><th>세율</th><th>세액</th></tr></thead>
            <tbody id="h_rows"><tr><td colspan="3" style="text-align:center;color:#6b7280">입력 후 ‘계산하기’를 눌러주세요.</td></tr></tbody>
            <tfoot><tr><th>합계 세액</th><th id="h_sum_rate">-</th><th id="h_sumY">-</th></tr></tfoot>
          </table>
          <div class="warn">※ 실제 고지서는 감면·중과, 절사 방식 등으로 차이가 있을 수 있으니 최종 고지서를 확인하세요.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- 2: 상가(오피스텔) 유상취득 -->
  <div id="view-calc2" class="view hidden" aria-labelledby="calc2-heading">
    <header class="appbar">
      <div class="row">
        <a class="icon-btn icon-only" href="javascript:void(0)" onclick="showView('menu')" title="뒤로" aria-label="뒤로">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path class="icon-stroke" d="M15 18l-6-6 6-6"/></svg>
        </a>
        <div class="brand"><span>2025년 취득세 계산(상가 매매)</span></div>
        <div class="app-actions">
          <a class="icon-btn" target="_blank" href="https://www.wetax.go.kr/tcp/loi/J030401M01.do" title="시가표준액 조회">시가표준액</a>
          <a class="icon-btn" target="_blank" href="https://www.realtyprice.kr/notice/main/mainBody.htm" title="주택가격 조회">주택가격</a>
          <a class="icon-btn" target="_blank" href="https://www.law.go.kr/LSW/lsSc.do?query=%EC%A7%80%EB%B0%A9%EC%84%B8%EB%B2%95">🔍 지방세법</a>
          <a class="icon-btn" target="_blank" href="https://www.wetax.go.kr/etq/etp/epi/E070101M01.do">🧾 위택스</a>
        </div>
      </div>
    </header>
    <div class="wrap">
      <h1 id="calc2-heading" class="title">2025년 취득세 계산(상가 매매)</h1>
      <div class="grid">
        <div class="card">
          <div class="header-row"><h2>1. 취득 정보 입력 <span class="unit">(단위: 원)</span></h2></div>
          <div class="input-grid">
            <div class="col col-amount">
              <label for="취득가액">취득가액(매매가)</label>
              <input id="취득가액" class="num" type="text" inputmode="numeric" placeholder="숫자만 입력" />
            </div>
            <div class="col col-date">
              <label for="잔금지급일">잔금지급일</label>
              <input id="잔금지급일" type="date" class="date" />
            </div>
          </div>
          <div class="btn-row" style="margin-top:14px;">
            <button class="btn" onclick="calc2()">✍️ 계산하기</button>
            <div class="quarter-gap" aria-hidden="true"></div>
            <div id="상가_quick_sum" class="quick-sum" role="status" aria-live="polite">
              <span class="label">총 합계 세액</span><span id="상가_quick_sum_value" class="value">-</span>
            </div>
          </div>
          <details class="center-30" style="margin-top:16px" open>
            <summary>세율 및 과세표준</summary>
            <table class="table nowrap">
              <tbody>
                <tr><td>과세표준</td><td id="과표">-</td></tr>
                <tr><td>취득세</td><td>4%</td></tr>
                <tr><td>농어특별세</td><td>0.2%</td></tr>
                <tr><td>지방교육세</td><td>0.4%</td></tr>
              </tbody>
            </table>
            <div class="deadline-box center-30" style="margin-top:10px">
              <div class="label">취득세 납부기한</div>
              <div class="value" id="납부기한">-</div>
            </div>
          </details>
        </div>
        <div class="card">
          <h2>2. 산출 세액</h2>
          <div class="sum-box" role="status" aria-live="polite">
            <div>
              <div class="label">총 합계 세액</div>
              <div class="value" id="sum_total">-</div>
            </div>
            <div>
              <div class="label">납부 안내</div>
              <div class="value note nowrap" id="sum_guide">취득(잔금지급일)일로부터 60일 내</div>
            </div>
          </div>
          <table class="table">
            <thead><tr><th>세목</th><th>세율</th><th>세액</th></tr></thead>
            <tbody id="tb"><tr><td colspan="3" style="text-align:center;color:#6b7280">입력 후 ‘계산하기’를 눌러주세요.</td></tr></tbody>
            <tfoot><tr><th>합계 세액</th><th>4.6%</th><th id="sumY">-</th></tr></tfoot>
          </table>
          <div class="warn">※ 실제 고지서는 감면·중과, 절사 방식 등으로 차이가 있을 수 있으니 최종 고지서를 확인하세요.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- 3: 상속 취득 -->
  <div id="view-calc3" class="view hidden" aria-labelledby="calc3-heading">
    <header class="appbar">
      <div class="row">
        <a class="icon-btn icon-only" href="javascript:void(0)" onclick="showView('menu')" title="뒤로" aria-label="뒤로">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path class="icon-stroke" d="M15 18l-6-6 6-6"/></svg>
        </a>
        <div class="brand"><span>2025년 취득세 계산(상속)</span></div>
        <div class="app-actions">
          <a class="icon-btn" target="_blank" href="https://www.wetax.go.kr/tcp/loi/J030401M01.do" title="시가표준액 조회">시가표준액</a>
          <a class="icon-btn" target="_blank" href="https://www.realtyprice.kr/notice/main/mainBody.htm" title="주택가격 조회">주택가격</a>
          <a class="icon-btn" target="_blank" href="https://www.law.go.kr/LSW/lsSc.do?query=%EC%A7%80%EB%B0%A9%EC%84%B8%EB%B2%95">🔍 지방세법</a>
          <a class="icon-btn" target="_blank" href="https://www.wetax.go.kr/etq/etp/epi/E070101M01.do">🧾 위택스</a>
        </div>
      </div>
    </header>
    <div class="wrap">
      <h1 id="calc3-heading" class="title">2025년 취득세 계산(상속)</h1>
    <div class="grid">
        <div class="card">
          <div class="header-row"><h2>1. 취득 정보 입력 <span class="unit">(단위: 원)</span></h2></div>

          <!-- 유형 선택 -->
          <div class="type-options box" id="typeOptions" role="group" aria-label="상속 취득 유형 선택"
               style="background:var(--card);border:1px solid var(--line);border-radius:12px;padding:8px;display:flex;gap:10px;flex-wrap:wrap;">
            <label style="display:inline-flex;align-items:center;gap:5px"><input type="checkbox" id="isHouse" /> <span>1. 주택</span></label>
            <span class="sep">|</span>
            <label style="display:inline-flex;align-items:center;gap:5px"><input type="checkbox" id="isNonHouse" /> <span>2. 주택이 아닌 부동산</span></label>
          </div>

          <div id="areaOptions" class="area-options hidden" aria-live="polite">
            <div class="icon-chip sky" id="areaBox" role="group" aria-label="전용면적 선택">
              <label><input type="checkbox" id="area_le_85" /> <span>전용면적 85m² 이하</span></label>
              <span class="sep">|</span>
              <label><input type="checkbox" id="area_gt_85" /> <span>전용면적 85m² 초과</span></label>
            </div>
            <div class="icon-chip yellow" id="specialBox" role="group" aria-label="세율 특례 선택" title="체크 시 취득세율 0.8% 적용 및 농어촌특별세 미부과">
              <label>
                <input type="checkbox" id="one_home_special" />
                <span>1가구1주택 세율 특례(특례적용 순서 ①지분이 가장 큰 자 ②상속주택 거주자 ③연장자)</span>
              </label>
            </div>
          </div>

          <div class="input-grid">
            <div class="col col-amount">
              <label for="상속_과세표준">과세표준(주택공시가격 또는 건물·토지 시가표준액)</label>
              <input id="상속_과세표준" class="num" type="text" inputmode="numeric" placeholder="숫자만 입력" />
            </div>
            <div class="col col-date">
              <label for="사망일">사망일(상속개시일)</label>
              <input id="사망일" type="date" class="date" />
            </div>
          </div>
          <div class="btn-row" style="margin-top:14px;">
            <button class="btn" onclick="calc3()">✍️ 계산하기</button>
            <div class="quarter-gap" aria-hidden="true"></div>
            <div id="상속_quick_sum" class="quick-sum" role="status" aria-live="polite">
              <span class="label">총 합계 세액</span><span id="상속_quick_sum_value" class="value">-</span>
            </div>
          </div>
          <details class="center-30" style="margin-top:16px" open>
            <summary>세율 및 과세표준</summary>
            <table class="table nowrap">
              <tbody>
                <tr><td>과세표준</td><td id="상속_과표">-</td></tr>
                <tr><td>취득세</td><td id="상속_취득세율셀">2.8%</td></tr>
                <tr><td>농어촌특별세</td><td id="상속_농특세율셀">0.2%</td></tr>
                <tr><td>지방교육세</td><td>0.16%</td></tr>
              </tbody>
            </table>
            <div class="deadline-box center-30" style="margin-top:10px">
              <div class="label">취득세 납부기한</div>
              <div class="value" id="상속_납부기한">-</div>
            </div>
          </details>
        </div>
        <div class="card">
          <h2>2. 산출 세액</h2>
          <div class="sum-box" role="status" aria-live="polite">
            <div>
              <div class="label">총 합계 세액</div>
              <div class="value" id="상속_sum_total">-</div>
            </div>
            <div>
              <div class="label">납부 안내</div>
              <!-- ▼ 기본 문구 변경 -->
              <div class="value note nowrap" id="상속_sum_guide">상속개시일(사망일)이 속하는 달의 말일부터 6개월 내</div>
            </div>
          </div>
          <table class="table">
            <thead><tr><th>세목</th><th>세율</th><th>세액</th></tr></thead>
            <tbody id="상속_tb"><tr><td colspan="3" style="text-align:center;color:#6b7280">입력 후 ‘계산하기’를 눌러주세요.</td></tr></tbody>
            <tfoot><tr><th>합계 세액</th><th id="상속_합계세율표시">3.16%</th><th id="상속_sumY">-</th></tr></tfoot>
          </table>
          <div class="warn">※ 실제 고지서는 감면·중과, 절사 방식 등으로 차이가 있을 수 있으니 최종 고지서를 확인하세요.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- 4: 증여 취득 -->
  <div id="view-calc4" class="view hidden" aria-labelledby="calc4-heading">
    <header class="appbar">
      <div class="row">
        <a class="icon-btn icon-only" href="javascript:void(0)" onclick="showView('menu')" title="뒤로" aria-label="뒤로">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path class="icon-stroke" d="M15 18l-6-6 6-6"/></svg>
        </a>
        <div class="brand"><span>2025년 취득세 계산(증여)</span></div>
        <div class="app-actions">
          <a class="icon-btn" target="_blank" href="https://www.wetax.go.kr/tcp/loi/J030901M01.do" title="시가인정액 조회">시가인정액</a>
          <a class="icon-btn" target="_blank" href="https://www.wetax.go.kr/tcp/loi/J030401M01.do" title="시가표준액 조회">시가표준액</a>
          <a class="icon-btn" target="_blank" href="https://www.realtyprice.kr/notice/main/mainBody.htm" title="주택가격 조회">주택가격</a>
          <a class="icon-btn" target="_blank" href="https://www.law.go.kr/LSW/lsSc.do?query=%EC%A7%80%EB%B0%A9%EC%84%B8%EB%B2%95">🔍 지방세법</a>
          <a class="icon-btn" target="_blank" href="https://www.wetax.go.kr/etq/etp/epi/E070101M01.do">🧾 위택스</a>
        </div>
      </div>
    </header>
    <div class="wrap">
      <h1 id="calc4-heading" class="title">2025년 취득세 계산(증여)</h1>
      <div class="grid">
        <div class="card">
          <div class="header-row"><h2>1. 취득 정보 입력 <span class="unit">(단위: 원)</span></h2></div>

          <!-- 유형 선택 -->
          <div class="type-options box" id="g_typeOptions" aria-label="증여 취득 유형 선택">
            <div class="icon-chip green" id="g_typeBox" role="group" aria-label="증여 취득 유형 선택">
              <label><input type="checkbox" id="g_isHouse" /> <span>1. 주택</span></label>
              <span class="sep">|</span>
              <label><input type="checkbox" id="g_isNonHouse" /> <span>2. 주택이 아닌 부동산</span></label>
            </div>
          </div>

          <!-- 전용면적 선택(주택만) -->
          <div id="g_areaOptions" class="area-options hidden" aria-live="polite">
            <div class="icon-chip sky" id="g_areaBox" role="group" aria-label="전용면적 선택">
              <label><input type="checkbox" id="g_area_le_85" /> <span>전용면적 85m² 이하</span></label>
              <span class="sep">|</span>
              <label><input type="checkbox" id="g_area_gt_85" /> <span>전용면적 85m² 초과</span></label>
            </div>
          </div>

          <div class="input-grid">
            <div class="col col-amount">
              <label for="증여_과세표준">과세표준(감정평가액,시가인정액,시가표준액)</label>
              <input id="증여_과세표준" class="num" type="text" inputmode="numeric" placeholder="숫자만 입력" />
            </div>
            <div class="col col-date">
              <label for="증여일">증여일(취득일)</label>
              <input id="증여일" type="date" class="date" />
            </div>
          </div>

          <div class="btn-row" style="margin-top:14px;">
            <button class="btn" onclick="calc4()">✍️ 계산하기</button>
            <div class="quarter-gap" aria-hidden="true"></div>
            <div id="증여_quick_sum" class="quick-sum" role="status" aria-live="polite">
              <span class="label">총 합계 세액</span><span id="증여_quick_sum_value" class="value">-</span>
            </div>
          </div>

          <details class="center-30" style="margin-top:16px" open>
            <summary>세율 및 과세표준</summary>
            <table class="table nowrap">
              <tbody>
                <tr><td>과세표준</td><td id="증여_과표">-</td></tr>
                <tr><td>취득세</td><td>3.5%</td></tr>
                <tr><td>농어촌특별세</td><td id="증여_농특세율셀">0.2%</td></tr>
                <tr><td>지방교육세</td><td>0.3%</td></tr>
              </tbody>
            </table>
            <div class="deadline-box center-30" style="margin-top:10px">
              <div class="label">취득세 납부기한</div>
              <div class="value" id="증여_납부기한">-</div>
            </div>
          </details>
        </div>

        <div class="card">
          <h2>2. 산출 세액</h2>
          <div class="sum-box" role="status" aria-live="polite">
            <div>
              <div class="label">총 합계 세액</div>
              <div class="value" id="증여_sum_total">-</div>
            </div>
            <div>
              <div class="label">납부 안내</div>
              <div class="value note nowrap" id="증여_sum_guide">취득일(증여일)로부터 60일 내</div>
            </div>
          </div>
          <table class="table">
            <thead><tr><th>세목</th><th>세율</th><th>세액</th></tr></thead>
            <tbody id="증여_tb"><tr><td colspan="3" style="text-align:center;color:#6b7280">입력 후 ‘계산하기’를 눌러주세요.</td></tr></tbody>
            <tfoot><tr><th>합계 세액</th><th id="증여_합계세율표시">4.00%</th><th id="증여_sumY">-</th></tr></tfoot>
          </table>
          <div class="warn">※ 실제 고지서는 감면·중과, 절사 방식 등으로 차이가 있을 수 있으니 최종 고지서를 확인하세요.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- 미리보기 오버레이 -->
  <div id="previewOverlay" role="dialog" aria-modal="true" aria-label="">
    <div class="preview-card">
      <div class="preview-toolbar">
        <div class="left"></div>
        <div class="right"></div>
      </div>
      <div class="preview-page-wrap">
        <div class="preview-page" id="previewPage">
          <div class="preview-content" id="previewContent"></div>
        </div>
      </div>
    </div>
  </div>

<script>
/* ===== 뷰 전환 & 스플래시 처리 ===== */
function showView(name, push = true){
  document.querySelectorAll('.view').forEach(v=>v.classList.add('hidden'));
  const el=document.getElementById('view-'+name);
  if(el){ el.classList.remove('hidden'); window.scrollTo(0,0);
    if(push){ try{ history.pushState({view:name}, '', '#'+name); }catch(e){} }
  }
}
window.addEventListener('popstate', (event)=>{
  const view = (event.state && event.state.view) || (location.hash ? location.hash.replace('#','') : 'menu');
  showView(view, false);
});
window.addEventListener('load',()=>{
  const sp=document.getElementById('splash');
  const endSplash=()=>{ if(!sp) return; sp.style.transition='opacity .35s ease'; sp.style.opacity='0';
    setTimeout(()=>{ sp.classList.add('hidden'); }, 360); };
  setTimeout(()=>{
    endSplash();
    const initial = location.hash ? location.hash.replace('#','') : 'menu';
    showView(initial, false);
    try{ history.replaceState({view:initial}, '', '#'+initial); }catch(e){}
  },2500);
});
</script>

<script>
/* ===== 공통 유틸 ===== */
const $=id=>document.getElementById(id);
const setText=(id,v)=>{const el=$(id);if(el)el.textContent=v;}
const setHTML=(id,v)=>{const el=$(id);if(el)el.innerHTML=v;}
const numOf=id=>Number((($(id)?.value)||'').replace(/,/g,'')||0);
const floor10=n=>Math.floor(n/10)*10; // 10원 절사
const fmt=n=>(Number.isFinite(n)?Math.floor(n).toLocaleString('ko-KR')+'원':'-');
const parseLocalDate=s=>{ if(!s) return null; const [y,m,d]=s.split('-').map(Number); return new Date(y, (m||1)-1, d||1); };
const addDays=(date,days)=>new Date(date.getFullYear(), date.getMonth(), date.getDate()+days);
const addMonths=(date,months)=>{ const d=new Date(date.getFullYear(), date.getMonth(), date.getDate()); d.setMonth(d.getMonth()+months); if(d.getDate()!==date.getDate()){ d.setDate(0); } return d; };
const formatYMD=d=>{ if(!d||Number.isNaN(+d)) return '-'; const y=d.getFullYear(); const m=String(d.getMonth()+1).padStart(2,'0'); const dd=String(d.getDate()).padStart(2,'0'); return `${y}-${m}-${dd}`; };
document.addEventListener('input',e=>{
  if(e.target.classList.contains('num')){
    let v=e.target.value.replace(/,/g,'').replace(/[^\d]/g,'');
    if(v===''){e.target.value='';return;}
    e.target.value=v.replace(/\B(?=(\d{3})+(?!\d))/g,",");
  }
});
</script>

<script>
/* ===== (1) 주택 매매 취득 — 세율 소수점 둘째자리까지 반영 ===== */
function h_ratePercent_2dp(price){
  if(price <= 600_000_000) return 1.00;     // %
  if(price <= 900_000_000){
    const rawPercent = (price * 2 / 300_000_000) - 3; // % 값
    return Math.round(rawPercent * 100) / 100;        // 둘째자리까지
  }
  return 3.00; // %
}
function h_rateDecimal_fromPercent(pct){ return pct / 100; }

function calc1(){
  const price = numOf('h_price');
  const type  = $('h_type')?.value || 'normal1';
  const over  = (($('h_area')?.value || 'under') === 'over');
  if(!(price > 0)){ alert('취득가액을 입력해주세요.'); return; }

  let acq=0, edu=0, rns=0; let rows=[];

  if(type === 'normal1'){
    const pct = h_ratePercent_2dp(price);
    const r_tax = h_rateDecimal_fromPercent(pct);
    acq = floor10(Math.floor(price * r_tax));
    rns = over ? floor10(Math.floor(price * 0.002)) : 0;
    edu = floor10(Math.floor(acq * 0.10));
    const pctText = pct.toFixed(2) + '%';
    rows = [
      ['취득세', pctText, fmt(acq)],
      ['지방교육세', '본세의 10%', fmt(edu)],
      ['농어촌특별세', over ? '0.2%' : '미부과', fmt(rns)]
    ];
    setText('h_rate_acq', pctText);
    setText('h_rate_nts', over ? '0.2%' : '미부과');
    setText('h_rate_edu', '본세의 10%');

  }else if(type === 'adj2'){
    acq = floor10(Math.floor(price * 0.08));
    edu = floor10(Math.floor(price * 0.004));
    rns = over ? floor10(Math.floor(price * 0.006)) : 0;
    rows = [
      ['취득세', '8%', fmt(acq)],
      ['지방교육세', '0.4%', fmt(edu)],
      ['농어촌특별세', over ? '0.6%' : '미부과', fmt(rns)]
    ];
    setText('h_rate_acq','8%');
    setText('h_rate_nts', over ? '0.6%' : '미부과');
    setText('h_rate_edu','0.4%');

  }else if(type === 'adj3'){
    acq = floor10(Math.floor(price * 0.12));
    edu = floor10(Math.floor(price * 0.004));
    rns = over ? floor10(Math.floor(price * 0.010)) : 0;
    rows = [
      ['취득세', '12%', fmt(acq)],
      ['지방교육세', '0.4%', fmt(edu)],
      ['농어촌특별세', over ? '1.0%' : '미부과', fmt(rns)]
    ];
    setText('h_rate_acq','12%');
    setText('h_rate_nts', over ? '1.0%' : '미부과');
    setText('h_rate_edu','0.4%');
  }

  const sum = acq + edu + rns;
  setHTML('h_rows', rows.map(([n,r,a])=>`<tr><td>${n}</td><td>${r}</td><td>${a}</td></tr>`).join(''));
  setText('h_sumY', fmt(sum));
  setText('h_sum_total', fmt(sum));
  setText('h_sum_rate', ((sum/price)*100).toFixed(2).replace(/\.?0+$/,'') + '%');
  setText('h_base', fmt(price));

  setText('h_sum_guide', '취득(잔금지급일)일로부터 60일 내');
  const ds = $('h_date')?.value || ''; let deadline='-';
  if(ds){ const d = parseLocalDate(ds); if(d){ deadline = formatYMD(addDays(d,60)); } }
  setText('h_deadline', deadline);

  // 버튼 옆 간이 합계 표시
  const quick=$('h_quick_sum'), quickV=$('h_quick_sum_value');
  if(quick && quickV){ quick.style.display='inline-flex'; quickV.textContent = fmt(sum); }
}

document.addEventListener('change', e=>{
  if(['h_type','h_area','h_date'].includes(e.target?.id)) calc1();
});
</script>

<script>
/* ===== (2) 상가 등 유상취득 ===== */
const ACQ_RATE=0.04, NTS_RATE=0.002, EDU_RATE=0.004;
function calc2(){
  const base=numOf('취득가액');
  const acq=floor10(base*ACQ_RATE), nts=floor10(base*NTS_RATE), edu=floor10(base*EDU_RATE);
  const sum=acq+nts+edu;
  const rows=[["취득세","4%",fmt(acq)],["농어촌특별세","0.2%",fmt(nts)],["지방교육세","0.4%",fmt(edu)]].map(([n,r,a])=>`<tr><td>${n}</td><td>${r}</td><td>${a}</td></tr>`).join('');
  setHTML('tb',rows); setText('sumY',fmt(sum)); setText('sum_total',fmt(sum)); setText('과표',fmt(base));
  setText('sum_guide','취득(잔금지급일)일로부터 60일 내');
  const payDateStr = $('잔금지급일')?.value || ''; let deadline='-';
  if(payDateStr){ const d=parseLocalDate(payDateStr); if(d){ deadline = formatYMD(addDays(d,60)); } }
  setText('납부기한', deadline);

  // 버튼 옆 간이 합계 표시
  const quick=$('상가_quick_sum'), quickV=$('상가_quick_sum_value');
  if(quick && quickV){ quick.style.display='inline-flex'; quickV.textContent = fmt(sum); }
}
document.addEventListener('change',e=>{ if(e.target && (e.target.id==='잔금지급일')) calc2(); });
</script>

<script>
/* ===== (3) 상속 취득 ===== */
const I_ACQ_RATE_DEFAULT=0.028, I_ACQ_RATE_SPECIAL=0.008;
const I_NTS_RATE=0.002, I_EDU_RATE=0.0016;
function enforceTypeExclusive(changedId){
  const a=$('isHouse'), b=$('isNonHouse');
  if(changedId==='isHouse' && a?.checked){ if(b) b.checked=false; }
  if(changedId==='isNonHouse' && b?.checked){ if(a) a.checked=false; }
}
function refreshAreaOptions(){
  const isHouse = $('isHouse')?.checked;
  const isNonHouse = $('isNonHouse')?.checked;
  if(isHouse && isNonHouse){ $('isNonHouse').checked=false; }
  const showArea = !!$('isHouse')?.checked && !$('isNonHouse')?.checked;
  const areaBox = $('areaOptions');
  if(areaBox){ areaBox.classList.toggle('hidden', !showArea); }
  if(!showArea){ const le=$('area_le_85'), gt=$('area_gt_85'), sp=$('one_home_special'); if(le) le.checked=false; if(gt) gt.checked=false; if(sp) sp.checked=false; }
}
function toggleArea(exclusiveId){
  ['area_le_85','area_gt_85'].forEach(id=>{ if(id!==exclusiveId){ const el=$(id); if(el) el.checked=false; } });
  if(exclusiveId==='area_le_85'){ const sp=$('one_home_special'); if(sp) sp.checked=false; }
}
function calc3(){
  const base=numOf('상속_과세표준');
  const isHouse = $('isHouse')?.checked || false;
  const isNonHouse = $('isNonHouse')?.checked || false;
  const le85 = $('area_le_85')?.checked || false;
  const special = $('one_home_special')?.checked || false;

  let ntsRate = I_NTS_RATE; let ntsRateLabel = '0.2%';
  if(isHouse && !isNonHouse && le85){ ntsRate = 0; ntsRateLabel = '미부과'; }
  if(special){ ntsRate = 0; ntsRateLabel = '미부과'; }

  let acqRate = I_ACQ_RATE_DEFAULT; if(special){ acqRate = I_ACQ_RATE_SPECIAL; }
  const acq=floor10(base*acqRate), nts=floor10(base*ntsRate), edu=floor10(base*I_EDU_RATE);
  const sum=acq+nts+edu;
  const rows=[["취득세",(acqRate*100).toFixed(1)+'%',fmt(acq)],["농어촌특별세",ntsRateLabel,fmt(nts)],["지방교육세","0.16%",fmt(edu)]].map(([n,r,a])=>`<tr><td>${n}</td><td>${r}</td><td>${a}</td></tr>`).join('');
  setHTML('상속_tb',rows); setText('상속_sumY',fmt(sum)); setText('상속_sum_total',fmt(sum)); setText('상속_과표',fmt(base));
  setText('상속_농특세율셀', ntsRateLabel); setText('상속_취득세율셀', (acqRate*100).toFixed(1)+'%');
  setText('상속_합계세율표시', ((acqRate + ntsRate + I_EDU_RATE)*100).toFixed(2) + '%');

  // ▼ 납부 안내 문구 및 납부기한 계산 수정
  setText('상속_sum_guide','상속개시일(사망일)이 속하는 달의 말일부터 6개월 내');
  const deathStr=$('사망일')?.value || '';
  let deadline='-';
  if(deathStr){
    const d=parseLocalDate(deathStr);
    if(d){
      const endOfMonth = new Date(d.getFullYear(), d.getMonth() + 1, 0); // 사망월 말일
      const sixMonthsAfterEOM = addMonths(endOfMonth, 6);               // 말일부터 6개월 후
      deadline = formatYMD(sixMonthsAfterEOM);
    }
  }
  setText('상속_납부기한', deadline);

  // 버튼 옆 간이 합계 표시
  const quick=$('상속_quick_sum'), quickV=$('상속_quick_sum_value');
  if(quick && quickV){ quick.style.display='inline-flex'; quickV.textContent = fmt(sum); }
}
document.addEventListener('change',e=>{
  const id = e.target?.id || '';
  if(id==='사망일') calc3();
  if(id==='isHouse' || id==='isNonHouse'){ enforceTypeExclusive(id); refreshAreaOptions(); calc3(); }
  if(id==='area_le_85'){ if(e.target.checked) toggleArea('area_le_85'); calc3(); }
  if(id==='area_gt_85'){ if(e.target.checked) toggleArea('area_gt_85'); calc3(); }
  if(id==='one_home_special') calc3();
});
document.addEventListener('DOMContentLoaded', ()=>{ refreshAreaOptions(); });
</script>

<script>
/* ===== (4) 증여 취득 ===== */
const G_ACQ_RATE=0.035, G_NTS_RATE=0.002, G_EDU_RATE=0.003; // 합계 4.0%
function g_enforceTypeExclusive(changedId){
  const a=$('g_isHouse'), b=$('g_isNonHouse');
  if(changedId==='g_isHouse' && a?.checked){ if(b) b.checked=false; }
  if(changedId==='g_isNonHouse' && b?.checked){ if(a) a.checked=false; }
}
function g_refreshAreaOptions(){
  const isHouse = $('g_isHouse')?.checked;
  const isNonHouse = $('g_isNonHouse')?.checked;
  if(isHouse && isNonHouse){ $('g_isNonHouse').checked=false; }
  const showArea = !!$('g_isHouse')?.checked && !$('g_isNonHouse')?.checked;
  const areaBox = $('g_areaOptions');
  if(areaBox){ areaBox.classList.toggle('hidden', !showArea); }
  if(!showArea){ const le=$('g_area_le_85'), gt=$('g_area_gt_85'); if(le) le.checked=false; if(gt) gt.checked=false; }
}
function g_toggleArea(exclusiveId){
  ['g_area_le_85','g_area_gt_85'].forEach(id=>{ if(id!==exclusiveId){ const el=$(id); if(el) el.checked=false; } });
}
function calc4(){
  const base=numOf('증여_과세표준');
  const isHouse = $('g_isHouse')?.checked || false;
  const isNonHouse = $('g_isNonHouse')?.checked || false;
  const le85 = $('g_area_le_85')?.checked || false;

  // 농특세: 주택 & 전용면적 ≤85m² 체크 시 미부과
  let ntsRate = G_NTS_RATE; let ntsRateLabel = '0.2%';
  if(isHouse && !isNonHouse && le85){ ntsRate = 0; ntsRateLabel = '미부과'; }

  const acq=floor10(base*G_ACQ_RATE), nts=floor10(base*ntsRate), edu=floor10(base*G_EDU_RATE);
  const sum=acq+nts+edu;

  const rows=[["취득세","3.5%",fmt(acq)],["농어촌특별세",ntsRateLabel,fmt(nts)],["지방교육세","0.3%",fmt(edu)]].map(([n,r,a])=>`<tr><td>${n}</td><td>${r}</td><td>${a}</td></tr>`).join('');
  setHTML('증여_tb',rows);
  setText('증여_sumY',fmt(sum));
  setText('증여_sum_total',fmt(sum));
  setText('증여_과표',fmt(base));
  setText('증여_농특세율셀', ntsRateLabel);
  setText('증여_합계세율표시', ((G_ACQ_RATE + ntsRate + G_EDU_RATE)*100).toFixed(2) + '%');

  // 납부기한/안내
  setText('증여_sum_guide','취득일(증여일)로부터 60일 내');
  const giftDateStr = $('증여일')?.value || ''; let deadline='-';
  if(giftDateStr){ const d=parseLocalDate(giftDateStr); if(d){ deadline = formatYMD(addDays(d,60)); } }
  setText('증여_납부기한', deadline);

  // 버튼 아래 간이 합계 표시
  const quick = $('증여_quick_sum'); const quickV = $('증여_quick_sum_value');
  if(quick && quickV){ quick.style.display='inline-flex'; quickV.textContent = fmt(sum); }
}
document.addEventListener('change',e=>{
  const id = e.target?.id || '';
  /* 날짜 변경 시 자동 계산 금지: 아래 줄 유지하지 않음 */
  // if(id==='증여일') calc4();
  if(id==='g_isHouse' || id==='g_isNonHouse'){ g_enforceTypeExclusive(id); g_refreshAreaOptions(); /* 자동 계산 원치 않으면 calc4() 호출 생략 */ }
  if(id==='g_area_le_85'){ if(e.target.checked) g_toggleArea('g_area_le_85'); /* calc4(); 생략 */ }
  if(id==='g_area_gt_85'){ if(e.target.checked) g_toggleArea('g_area_gt_85'); /* calc4(); 생략 */ }
});
document.addEventListener('DOMContentLoaded', ()=>{ g_refreshAreaOptions(); });
</script>

<script>
/* ===== PWA 설치 ===== */
let deferredPrompt=null;
function isStandalone(){
  try{
    return window.matchMedia('(display-mode: standalone)').matches
      || window.matchMedia('(display-mode: window-controls-overlay)').matches
      || window.navigator.standalone === true;
  }catch(e){ return false; }
}
function setInstallButtonsVisible(visible){
  document.querySelectorAll('.btn-install').forEach(el=>{ el.style.display = visible ? '' : 'none'; });
  document.body.classList.toggle('installed', !visible);
}
function updateInstallUI(){ const installed = isStandalone(); setInstallButtonsVisible(!installed); }
const isiOS = /iPad|iPhone|iPod/i.test(navigator.userAgent);
const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
window.addEventListener('beforeinstallprompt',(e)=>{ e.preventDefault(); deferredPrompt=e; updateInstallUI(); });
window.addEventListener('appinstalled', ()=>{ deferredPrompt=null; setInstallButtonsVisible(false); setTimeout(()=>{ try{ location.reload(); }catch(e){} }, 300); });
async function openInstall(){
  try{
    if(isStandalone()){ setInstallButtonsVisible(false); return; }
    if(deferredPrompt){ deferredPrompt.prompt(); const choice = await deferredPrompt.userChoice.catch(()=>null); deferredPrompt=null; if(!choice || choice.outcome!=='accepted'){ updateInstallUI(); } return; }
    if(isiOS && isSafari){ alert('iOS 사파리: 공유(⬆️) 버튼 → "홈 화면에 추가"를 눌러 설치하세요.'); }
    else{ alert('브라우저 메뉴에서 "앱 설치" 또는 주소창 우측 설치 아이콘을 눌러 설치하세요.'); }
  }catch(e){ console.error(e); }
}
['load','pageshow','visibilitychange'].forEach(evt=>{ window.addEventListener(evt, updateInstallUI); });
try{ window.matchMedia('(display-mode: standalone)').addEventListener('change', updateInstallUI); }catch(e){}
</script>

<script>
/* ===== 미리보기 ===== */
function getActiveView(){
  const v = Array.from(document.querySelectorAll('.view')).find(el=>!el.classList.contains('hidden'));
  return v || document.getElementById('view-menu');
}
function openOnePagePreview(){
  try{ calc1(); }catch(e){} try{ calc2(); }catch(e){} try{ calc3(); }catch(e){} try{ calc4(); }catch(e){}
  const overlay = $('previewOverlay'), page = $('previewPage'), content = $('previewContent');
  if(!overlay||!page||!content) return;
  const active = getActiveView(); const clone = active.cloneNode(true); clone.setAttribute('data-preview','1');
  const holder = document.createElement('div'); holder.className='preview-scale'; holder.appendChild(clone);
  content.innerHTML=''; content.appendChild(holder);
  overlay.classList.add('show'); requestAnimationFrame(fitPreviewScale);
}
function fitPreviewScale(){
  const page = $('previewPage'), content = $('previewContent');
  const holder = content && content.querySelector('.preview-scale'); if(!page||!content||!holder) return;
  const targetW = page.clientWidth - 24, targetH = page.clientHeight - 24;
  holder.style.transform='scale(1)';
  const naturalW = holder.scrollWidth || holder.offsetWidth || targetW;
  const naturalH = holder.scrollHeight || holder.offsetHeight || targetH;
  const scale = Math.min(targetW / naturalW, targetH / naturalH, 1); holder.style.transform = `scale(${scale})`;
}
window.addEventListener('resize', fitPreviewScale);
</script>
  <script>
/* ===== 폼 상태 자동 저장/복원 ===== */
const FORM_KEYS = [
  // calc1
  'h_price','h_date','h_type','h_area',
  // calc2
  '취득가액','잔금지급일',
  // calc3
  'isHouse','isNonHouse','area_le_85','area_gt_85','one_home_special','상속_과세표준','사망일',
  // calc4
  'g_isHouse','g_isNonHouse','g_area_le_85','g_area_gt_85','증여_과세표준','증여일'
];

function saveFormState(){
  try{
    const data = {};
    FORM_KEYS.forEach(id=>{
      const el = document.getElementById(id);
      if(!el) return;
      data[id] = (el.type === 'checkbox') ? !!el.checked : (el.value ?? '');
    });
    localStorage.setItem('acqtax_state_v1', JSON.stringify(data));
  }catch(e){}
}

function loadFormState(){
  try{
    const raw = localStorage.getItem('acqtax_state_v1');
    if(!raw) return;
    const data = JSON.parse(raw);
    Object.entries(data).forEach(([id,val])=>{
      const el = document.getElementById(id);
      if(!el) return;
      if(el.type === 'checkbox'){ el.checked = !!val; }
      else{ el.value = val; }
    });

    try{ refreshAreaOptions(); }catch(e){}
    try{ g_refreshAreaOptions(); }catch(e){}
    try{ if(typeof calc1==='function') calc1(); }catch(e){}
    try{ if(typeof calc2==='function') calc2(); }catch(e){}
    try{ if(typeof calc3==='function') calc3(); }catch(e){}
    try{ if(typeof calc4==='function') calc4(); }catch(e){}
  }catch(e){}
}

document.addEventListener('input', (e)=>{
  if(!e.target) return;
  if(FORM_KEYS.includes(e.target.id)) saveFormState();
});
document.addEventListener('change', (e)=>{
  if(!e.target) return;
  if(FORM_KEYS.includes(e.target.id)) saveFormState();
});

window.addEventListener('DOMContentLoaded', loadFormState);
</script>
</body>
</html>
.
